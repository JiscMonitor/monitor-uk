<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: muk.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: muk.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @namespace */
var muk = {

    /**
     * where we'll store the page's active Edges
     *
     * @type {Object}
     */
    activeEdges : {},

    /**
     * Calculate a set of year ranges based on a specified list of boundaries, and a number of years to lookback
     *
     * @param {Object} boundaries a set of key value pairs, setting the month/year boundaries.  E.g. { "academic year" : "09-01" }
     * @param {Object} lookback a set of key value pairs setting the prefixes and the number of years to lookback.  e.g. {"This " : 0, "Last" : 1}
     * @returns {Object} a set of ranges of the form {range : [start, end]}
     */
    yearRanges : function(boundaries, lookback) {
        var keys = Object.keys(boundaries);
        var now = moment();
        var ranges = {};

        for (var i = 0; i &lt; keys.length; i++) {
            var key = keys[i];
            var boundary = boundaries[key];
            var tyb = moment(now.year() + "-" + boundary, "YYYY-MM-DD");

            var upper = false;
            var lower = false;
            if (now &lt;= tyb) {
                upper = moment(tyb).subtract(1, "day");
                lower = moment(tyb).subtract(1, "year");
            } else {
                upper = moment(tyb).add(1, "year").subtract(1, "day");
                lower = moment(tyb);
            }

            // now for each lookback, create the key and the range
            var prefixes = Object.keys(lookback);
            for (var j = 0; j &lt; prefixes.length; j++) {
                var prefix = prefixes[j];
                var offset = lookback[prefix];
                var name = prefix + key;
                if (offset === 0) {
                    ranges[name] = [lower, upper];
                } else {
                    ranges[name] = [moment(lower).subtract(offset, "year"), moment(upper).subtract(offset, "year")];
                }
            }
        }

        return ranges;
    },

    /**
     * Return a function that will suitably format an integer for the UI
     *
     * @returns {Function} can be called to format an int
     */
    toIntFormat : function() {
        return edges.numFormat({
            decimalPlaces: 0,
            thousandsSeparator: ","
        })
    },

    /**
     * Return a function that will suitably format an GBP currency value for the UI
     *
     * @returns {Function} can be called to format a currency value
     */
    toGBPIntFormat : function() {
        return edges.numFormat({
            prefix: "Â£",
            decimalPlaces: 0,
            thousandsSeparator: ","
        })
    }
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="muk.funder.FunderReportTemplate.html">FunderReportTemplate</a></li><li><a href="muk.funder.Story.html">Story</a></li><li><a href="muk.institution.InstitutionReportTemplate.html">InstitutionReportTemplate</a></li><li><a href="muk.institution.Story.html">Story</a></li><li><a href="muk.publisher.PublisherReportTemplate.html">PublisherReportTemplate</a></li><li><a href="muk.publisher.Story.html">Story</a></li><li><a href="muk.search.APCRenderer.html">APCRenderer</a></li><li><a href="muk.search.SearchTemplate.html">SearchTemplate</a></li></ul><h3>Namespaces</h3><ul><li><a href="muk.html">muk</a></li><li><a href="muk.funder.html">funder</a></li><li><a href="muk.institution.html">institution</a></li><li><a href="muk.publisher.html">publisher</a></li><li><a href="muk.search.html">search</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Fri Sep 02 2016 16:41:15 GMT+0100 (BST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
